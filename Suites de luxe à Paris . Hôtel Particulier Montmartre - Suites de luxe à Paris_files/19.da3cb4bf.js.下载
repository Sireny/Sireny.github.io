(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{75:function(e,t,i){"use strict";function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}i.r(t),i.d(t,"default",function(){return n});var N=i(49),r=".distorsionHoverEffect",n=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.isLoaded=!1,this.App=e,this.countLoaded=0}var e,i,n;return e=t,(i=[{key:"initialize",value:function(){this.elems=Array.from(document.querySelectorAll(r)),this.nbElems=this.elems.length,document.documentElement.classList.add("distorsionHover"),this.init()}},{key:"init",value:function(){var n=this,o=this;this.elems.forEach(function(e){return t=e,void((i=Array.from(t.querySelectorAll("img"))).length<2?o.isInit():new n.hoverEffect({parent:t,sens:t.dataset.distorsionSens||void 0,intensity:t.dataset.distorsionIntensity||void 0,speedIn:t.dataset.distorsionSpeedin||void 0,easing:t.dataset.distorsionEasing||void 0,hover:t.dataset.distorsionHover||void 0,images:i,image1:i[0].getAttribute("data-src")?i[0].getAttribute("data-src"):i[0].getAttribute("src"),image2:i[1].getAttribute("data-src")?i[1].getAttribute("data-src"):i[1].getAttribute("src"),displacementImage:t.dataset.distorsionDisplacement||site_theme_url+"/dist/displacement.png"},o.App));var t,i})}},{key:"isInit",value:function(){this.isLoaded||(this.countLoaded+=1,this.countLoaded<this.nbElems||(this.isLoaded=!0,this.App.loadProgress+=1,this.App.checkAppLoaded()))}},{key:"hoverEffect",value:function(e,o){var a=e.parent||console.warn("no parent"),t=e.displacementImage||console.warn("displacement image missing"),i=e.images||console.warn("images missing"),n=[],r=e.sens||-1,s=e.intensity*r||.3*r,u=e.speedIn||1.5*o.variables.transition_slow__inS,d=void 0===e.hover||e.hover,l=e.easing||"Expo.easeInOut",c=!1,v=0,f=0,m=i.length,p=1,h=a.querySelector(".double-image__dots"),g=Array.from(h.querySelectorAll("button")),x=null,w={type:null,startCoords:null,pointerCoords:null,minDrag:10,maxDrag:0,moveX:0},y=!1,b=!1;Util.addClass(a,"isInit");var C=new N.Scene,A=new N.OrthographicCamera(a.offsetWidth/-2,a.offsetWidth/2,a.offsetHeight/2,a.offsetHeight/-2,1,1e3);A.position.z=1;var F=new N.WebGLRenderer({antialias:!1});F.setPixelRatio(window.devicePixelRatio),F.setClearColor(16777215,0),F.setSize(a.offsetWidth,a.offsetHeight),a.appendChild(F.domElement);var E=new N.TextureLoader;E.crossOrigin="";var I,U=0;i.forEach(function(e){var t=e.getAttribute("data-src")?e.getAttribute("data-src"):e.getAttribute("src");(I=0===U?E.load(t+"?v="+Date.now(),function(e){var t=function(e){e.image.width,e.image.height;var t=e.image.width/e.image.height,i=a.offsetWidth,n=a.offsetHeight,o=n*t,r=n;return o<i&&(r=(o=i)/t),{w:o,h:r}}(e),i=new N.PlaneBufferGeometry(t.w,t.h,1),n=new N.Mesh(i,L);C.add(n),o.DistorsionHover.isInit()}):E.load(t+"?v="+Date.now())).magFilter=I.minFilter=N.LinearFilter,I.anisotropy=F.capabilities.getMaxAnisotropy(),n.push(I),U++});var S=E.load(t);S.wrapS=S.wrapT=N.RepeatWrapping;var L=new N.ShaderMaterial({uniforms:{effectFactor:{type:"f",value:s},dispFactor:{type:"f",value:0},texture:{type:"t",value:n[0]},texture2:{type:"t",value:n[1]},disp:{type:"t",value:S}},vertexShader:"\n            varying vec2 vUv;\n            void main() {\n              vUv = uv;\n              gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n            }\n        ",fragmentShader:"\n            varying vec2 vUv;\n\n            uniform sampler2D texture;\n            uniform sampler2D texture2;\n            uniform sampler2D disp;\n\n            // uniform float time;\n            // uniform float _rot;\n            uniform float dispFactor;\n            uniform float effectFactor;\n\n            // vec2 rotate(vec2 v, float a) {\n            //  float s = sin(a);\n            //  float c = cos(a);\n            //  mat2 m = mat2(c, -s, s, c);\n            //  return m * v;\n            // }\n\n            void main() {\n\n                vec2 uv = vUv;\n\n                // uv -= 0.5;\n                // vec2 rotUV = rotate(uv, _rot);\n                // uv += 0.5;\n\n                vec4 disp = texture2D(disp, uv);\n\n                vec2 distortedPosition = vec2(uv.x + dispFactor * (disp.r*effectFactor), uv.y);\n                vec2 distortedPosition2 = vec2(uv.x - (1.0 - dispFactor) * (disp.r*effectFactor), uv.y);\n\n                vec4 _texture = texture2D(texture, distortedPosition);\n                vec4 _texture2 = texture2D(texture2, distortedPosition2);\n\n                vec4 finalTexture = mix(_texture, _texture2, dispFactor);\n\n                gl_FragColor = finalTexture;\n                // gl_FragColor = disp;\n            }\n        ",transparent:!0,opacity:1});window.addEventListener("resize",function(e){F.setSize(a.offsetWidth,a.offsetHeight)});var D=!1,_=null,M=function(){D=!0,_=null,function e(){D&&(_=requestAnimationFrame(e)),F.render(C,A)}()},T=function(){D=!1,_=null,cancelAnimationFrame(_)},q=function(){L.uniforms.texture2.value=n[f],L.uniforms.texture2.needsUpdate=!0},k=function(){L.uniforms.effectFactor.value=s*p},W=function(){var e=v+1;m<=e&&(e=0),h.querySelector('[data-slide="'+e+'"]').click()},P=function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];null!==x&&(Util.clearRequestInterval(x),x=null),e&&(x=Util.requestInterval(W,4e3))},H=function(e){M(),P(!1),w.type="touchstart"==e.type?"touch":"mouse",p=!1,w.startCoords="touch"==w.type?{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}:{x:e.x,y:e.y},w.maxDrag=o.env.isMobile?a.offsetWidth<500?a.offsetWidth/2:a.offsetWidth/3:a.offsetWidth/4};H=H.bind(this);var V=function(e){if(null!==w.startCoords){w.pointerCoords="touch"==w.type?{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}:{x:e.x,y:e.y},w.moveX=w.startCoords.x-w.pointerCoords.x;var t=w.moveX,i=Math.abs(t);if(i>w.minDrag&&(y=!0),y){!1===p&&(p=0<t?1:-1,debug("slideDirection",p),k(),m<=(f=0<p?v+1:v-1)?f=0:f<0&&(f=m-1),q());var n=i/w.maxDrag;n<0?n=0:1<n&&(n=1),TweenMax.to(L.uniforms.dispFactor,.1,{value:n})}}};V=V.bind(this);var X=function(e){if(b=y,y=!1,b){if(Math.abs(w.moveX)>w.maxDrag/2){v=f,TweenMax.to(L.uniforms.dispFactor,u/2,{value:1,ease:"Expo.easeInOut",onComplete:function(){L.uniforms.texture.value=n[v],L.uniforms.texture.needsUpdate=!0,L.uniforms.dispFactor.value=0,T()}});var t=h.querySelectorAll(".active");t&&Util.removeClass(t[0],"active");var i=h.querySelector('[data-slide="'.concat(v,'"]'));i&&Util.addClass(i,"active")}else TweenMax.to(L.uniforms.dispFactor,u/2,{value:0,ease:"Expo.easeInOut",onComplete:function(){T()}});p=f=!1}else T();w.startCoords=w.pointerCoords=w.moveX=null,P()};X=X.bind(this);var O,z,R,j;d&&(O="mousedown",z="mousemove",R="mouseup",j="mouseupoutside",o.env.isMobile&&(O="touchstart",z="touchmove",R="touchend",j="touchendoutside"),a.addEventListener(O,H),a.addEventListener(R,X),a.addEventListener(j,X),a.addEventListener(z,throttle(function(e){V(e)},30)),g.forEach(function(e){e.addEventListener("click",function(){c||(c=!0,M(),f=parseInt(this.dataset.slide,10),Util.removeClass(h.querySelectorAll(".active")[0],"active"),Util.addClass(this,"active"),p=f<v?-1:1,k(),q(),TweenMax.to(L.uniforms.dispFactor,u,{value:1,ease:l,onComplete:function(){L.uniforms.texture.value=n[f],L.uniforms.texture.needsUpdate=!0,L.uniforms.dispFactor.value=0,c=!1,v=f,T()}}))})}),h.querySelector('[data-slide="0"]').click());var G=function(){Util.addClass(a,"isInViewport"),Util.removeClass(a,"isNotInViewport"),M(),P()},J=Util.isInViewport(a);J&&G(),window.addEventListener("scroll",throttle(function(e){Util.isInViewport(a)?J||(J=!0,G()):J&&(J=!1,Util.addClass(a,"isNotInViewport"),Util.removeClass(a,"isInViewport"),T(),P(!1))},30))}}])&&o(e.prototype,i),n&&o(e,n),t}()}}]);
//# sourceMappingURL=19.da3cb4bf.js.map